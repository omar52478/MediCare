{% extends 'base.html' %}
{% load static %}
{% block title %}Manage Patients - Admin{% endblock %}
{% block content %}
<div class="container">
<div class="admin-page-header fade-in">
<div class="header-left">
<a href="{% url 'admin_dashboard' %}" class="back-btn"><i class="fas fa-arrow-left"></i></a>
<div>
<h1><i class="fas fa-users"></i> Manage Patients</h1>
<p>{{ total_count }} patients registered in system</p>
</div>
</div>
</div>
<div class="search-section glass-card fade-in">
<form method="get" class="search-form">
<div class="input-wrapper">
<input type="text" name="search" placeholder="Search by name, email, phone, or national ID..." value="{{ search }}" class="search-input">
<i class="fas fa-search input-icon"></i>
</div>
<button type="submit" class="btn btn-primary"><i class="fas fa-search"></i> Search</button>
{% if search %}<a href="{% url 'admin_patients' %}" class="btn btn-secondary"><i class="fas fa-times"></i> Clear</a>{% endif %}
</form>
</div>
<div class="admin-table-card glass-card fade-in">
<div class="table-responsive">
<table class="admin-table">
<thead>
<tr>
<th><i class="fas fa-user"></i> Patient</th>
<th><i class="fas fa-phone"></i> Phone</th>
<th><i class="fas fa-birthday-cake"></i> Age</th>
<th><i class="fas fa-id-card"></i> National ID</th>
<th><i class="fas fa-map-marker-alt"></i> Location</th>
<th><i class="fas fa-cog"></i> Actions</th>
</tr>
</thead>
<tbody>
{% for patient in patients %}
<tr>
<td>
<div class="user-cell">
<div class="user-avatar"><span>{{ patient.user.first_name|slice:":1"|upper }}</span><span>{{ patient.user.last_name|slice:":1"|upper }}</span></div>
<div class="user-info">
<span class="user-name"><span>{{ patient.user.first_name }}</span> <span>{{ patient.user.last_name }}</span></span>
<span class="user-email">{{ patient.user.email }}</span>
</div>
</div>
</td>
<td><span class="phone-badge"><i class="fas fa-phone"></i> {{ patient.phone }}</span></td>
<td><span class="age-badge">{% if patient.age and patient.age > 0 %}{{ patient.age }} yrs{% else %}N/A{% endif %}</span></td>
<td><code class="national-id">{{ patient.national_id }}</code></td>
<td><div class="location-cell"><i class="fas fa-map-marker-alt"></i><span class="location-text"><span>{{ patient.city }}</span>, <span>{{ patient.governorate }}</span></span></div></td>
<td>
<div class="action-buttons">
<a href="{% url 'admin_patient_detail' patient.id %}" class="action-btn view" title="View Details"><i class="fas fa-eye"></i></a>
<a href="{% url 'admin_patient_delete' patient.id %}" class="action-btn delete" onclick="return confirm('Delete this patient?')" title="Delete"><i class="fas fa-trash-alt"></i></a>
</div>
</td>
</tr>
{% empty %}
<tr><td colspan="6" class="empty-state"><div class="empty-content"><i class="fas fa-users-slash"></i><h3>No patients found</h3><p>Try adjusting your search criteria</p></div></td></tr>
{% endfor %}
</tbody>
</table>
</div>
{% if patients.has_other_pages %}
<div class="pagination-wrapper">
<div class="pagination">
{% if patients.has_previous %}<a href="?page=1{% if search %}&search={{ search }}{% endif %}" class="page-btn first"><i class="fas fa-angle-double-left"></i></a><a href="?page={{ patients.previous_page_number }}{% if search %}&search={{ search }}{% endif %}" class="page-btn"><i class="fas fa-chevron-left"></i></a>{% endif %}
{% for num in patients.paginator.page_range %}{% if patients.number == num %}<span class="page-btn active">{{ num }}</span>{% elif num > patients.number|add:'-4' and num < patients.number|add:'4' %}<a href="?page={{ num }}{% if search %}&search={{ search }}{% endif %}" class="page-btn">{{ num }}</a>{% endif %}{% endfor %}
{% if patients.has_next %}<a href="?page={{ patients.next_page_number }}{% if search %}&search={{ search }}{% endif %}" class="page-btn"><i class="fas fa-chevron-right"></i></a><a href="?page={{ patients.paginator.num_pages }}{% if search %}&search={{ search }}{% endif %}" class="page-btn last"><i class="fas fa-angle-double-right"></i></a>{% endif %}
</div>
<span class="page-info">Showing page <strong>{{ patients.number }}</strong> of <strong>{{ patients.paginator.num_pages }}</strong> ({{ total_count }} records)</span>
</div>
{% endif %}
</div>
</div>
{% endblock %}
{% block extra_css %}
<style>
.admin-page-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;padding:1.5rem 0}
.header-left{display:flex;align-items:center;gap:1.5rem}
.back-btn{width:55px;height:55px;background:linear-gradient(135deg,#0ea5e9 0%,#06b6d4 100%);border-radius:16px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.3rem;transition:all .3s ease;box-shadow:0 8px 25px rgba(14,165,233,.4)}
.back-btn:hover{transform:translateX(-5px) scale(1.05);box-shadow:0 12px 35px rgba(14,165,233,.5)}
.admin-page-header h1{font-size:2.2rem;display:flex;align-items:center;gap:.75rem;margin-bottom:5px;background:linear-gradient(135deg,#0ea5e9,#06b6d4);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.admin-page-header h1 i{-webkit-text-fill-color:#0ea5e9}
.admin-page-header p{color:#94a3b8;margin:0;font-size:1rem}
.search-section{padding:1.5rem;margin-bottom:2rem;background:linear-gradient(135deg,rgba(14,165,233,.1),rgba(6,182,212,.05));border:1px solid rgba(14,165,233,.2)}
.search-form{display:flex;gap:1rem;flex-wrap:wrap;align-items:center}
.search-form .input-wrapper{flex:1;min-width:320px;position:relative}
.input-icon{position:absolute;left:18px;top:50%;transform:translateY(-50%);color:#64748b;pointer-events:none;font-size:1rem}
.search-input{width:100%;padding:14px 14px 14px 50px;background:rgba(15,23,42,.6);border:2px solid rgba(148,163,184,.2);border-radius:14px;color:#fff;font-size:1rem;transition:all .3s ease}
.search-input:focus{outline:none;border-color:#0ea5e9;background:rgba(14,165,233,.1);box-shadow:0 0 0 4px rgba(14,165,233,.15)}
.search-input::placeholder{color:#64748b}
.admin-table-card{padding:0;overflow:hidden;border-radius:24px;background:linear-gradient(135deg,rgba(30,41,59,.9),rgba(15,23,42,.95));border:1px solid rgba(148,163,184,.1);box-shadow:0 25px 50px -12px rgba(0,0,0,.5)}
.table-responsive{overflow-x:auto}
.admin-table{width:100%;border-collapse:collapse}
.admin-table th{padding:20px 24px;text-align:left;background:linear-gradient(135deg,rgba(14,165,233,.15),rgba(6,182,212,.1));color:#e2e8f0;font-weight:700;font-size:.8rem;text-transform:uppercase;letter-spacing:1.5px;border-bottom:2px solid rgba(14,165,233,.3)}
.admin-table th i{margin-right:8px;color:#0ea5e9}
.admin-table td{padding:18px 24px;border-bottom:1px solid rgba(148,163,184,.08);vertical-align:middle}
.admin-table tbody tr{transition:all .3s ease}
.admin-table tbody tr:hover{background:linear-gradient(135deg,rgba(14,165,233,.08),rgba(6,182,212,.05))}
.user-cell{display:flex;align-items:center;gap:14px}
.user-avatar{width:48px;height:48px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:.9rem;flex-shrink:0;background:linear-gradient(135deg,#667eea,#764ba2);box-shadow:0 6px 20px rgba(102,126,234,.4)}
.user-info{display:flex;flex-direction:column;gap:3px}
.user-name{font-weight:600;color:#f1f5f9;font-size:.95rem}
.user-email{font-size:.8rem;color:#64748b}
.phone-badge{display:inline-flex;align-items:center;gap:10px;background:linear-gradient(135deg,rgba(34,197,94,.2),rgba(74,222,128,.1));color:#4ade80;padding:10px 16px;border-radius:12px;font-size:.9rem;font-weight:600;border:1px solid rgba(74,222,128,.3)}
.phone-badge i{font-size:.85rem}
.age-badge{background:linear-gradient(135deg,rgba(168,85,247,.2),rgba(192,132,252,.1));color:#c084fc;padding:10px 16px;border-radius:12px;font-size:.9rem;font-weight:700;border:1px solid rgba(192,132,252,.3);white-space:nowrap}
.national-id{background:linear-gradient(135deg,rgba(99,102,241,.2),rgba(129,140,248,.1));padding:10px 16px;border-radius:12px;font-family:'Fira Code',monospace;font-size:.85rem;color:#818cf8;border:1px solid rgba(129,140,248,.3)}
.location-cell{display:flex;align-items:center;gap:10px;color:#94a3b8;font-size:.9rem}
.location-cell i{color:#f87171;font-size:1rem}
.location-text{color:#e2e8f0}
.action-buttons{display:flex;gap:10px}
.action-btn{width:42px;height:42px;border-radius:12px;display:flex;align-items:center;justify-content:center;transition:all .3s ease}
.action-btn.view{background:linear-gradient(135deg,rgba(59,130,246,.2),rgba(96,165,250,.1));color:#60a5fa;border:1px solid rgba(96,165,250,.3)}
.action-btn.view:hover{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;transform:scale(1.15);box-shadow:0 8px 25px rgba(59,130,246,.5)}
.action-btn.delete{background:linear-gradient(135deg,rgba(239,68,68,.2),rgba(248,113,113,.1));color:#f87171;border:1px solid rgba(248,113,113,.3)}
.action-btn.delete:hover{background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;transform:scale(1.15);box-shadow:0 8px 25px rgba(239,68,68,.5)}
.empty-state{text-align:center;padding:80px 20px!important}
.empty-content{display:flex;flex-direction:column;align-items:center;gap:16px}
.empty-content i{font-size:5rem;background:linear-gradient(135deg,#0ea5e9,#06b6d4);-webkit-background-clip:text;-webkit-text-fill-color:transparent;opacity:.5}
.empty-content h3{color:#e2e8f0;font-size:1.5rem;margin:0}
.empty-content p{color:#64748b;margin:0}
.pagination-wrapper{display:flex;flex-direction:column;align-items:center;gap:16px;padding:24px;background:linear-gradient(135deg,rgba(14,165,233,.08),rgba(6,182,212,.05));border-top:1px solid rgba(148,163,184,.1)}
.pagination{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
.page-btn{min-width:44px;height:44px;padding:0 14px;display:flex;align-items:center;justify-content:center;border-radius:12px;background:rgba(30,41,59,.8);color:#94a3b8;border:1px solid rgba(148,163,184,.15);transition:all .3s ease;font-weight:600;font-size:.95rem}
.page-btn:hover{background:linear-gradient(135deg,#0ea5e9,#06b6d4);color:#fff;transform:translateY(-2px);box-shadow:0 8px 20px rgba(14,165,233,.4);border-color:transparent}
.page-btn.active{background:linear-gradient(135deg,#0ea5e9,#06b6d4);color:#fff;box-shadow:0 8px 25px rgba(14,165,233,.5);border-color:transparent;transform:scale(1.05)}
.page-btn.first,.page-btn.last{background:rgba(14,165,233,.15);color:#0ea5e9;border-color:rgba(14,165,233,.3)}
.page-info{color:#94a3b8;font-size:.9rem}
.page-info strong{color:#0ea5e9}
@media(max-width:768px){.search-form{flex-direction:column}.search-form .input-wrapper{min-width:100%}.admin-page-header h1{font-size:1.6rem}.pagination{gap:6px}.page-btn{min-width:38px;height:38px;font-size:.85rem}}
</style>
{% endblock %}